import{_ as e,o as r,c as l,V as a}from"./chunks/framework.e0e258e1.js";const m=JSON.parse('{"title":"1216 今日总结","description":"","frontmatter":{},"headers":[],"relativePath":"record-2021/12/1216.md","filePath":"record-2021/12/1216.md"}'),t={name:"record-2021/12/1216.md"},i=a('<h1 id="_1216-今日总结" tabindex="-1">1216 今日总结 <a class="header-anchor" href="#_1216-今日总结" aria-label="Permalink to &quot;1216 今日总结&quot;">​</a></h1><p><img src="http://h2.ioliu.cn/bing/LittleBlueHeron_ZH-CN0892428603_1920x1080.jpg" alt=""></p><h2 id="今日工作" tabindex="-1">今日工作 <a class="header-anchor" href="#今日工作" aria-label="Permalink to &quot;今日工作&quot;">​</a></h2><p><strong>问题</strong></p><ul><li>问题1：iframe click 事件无效#TODO</li></ul><p><strong>原因</strong></p><ul><li>问题1：iframe 不支持指针事件；</li><li>其次：iframe 加载的是跨域资源，无法操作跨域资源；</li></ul><p><strong>解决方式</strong></p><ul><li>问题1：iframe click 事件无效，暂时无法解决，先挂着后续再看#TODO；</li><li>解决方式考虑换掉 iframe 作为 pdf 的 viewer 的方式，考虑使用 <ul><li><a href="https://github.com/mozilla/pdf.js#online-demo" target="_blank" rel="noreferrer">pdf.js/github</a>， <a href="https://mozilla.github.io/pdf.js/web/viewer.html" target="_blank" rel="noreferrer">demo</a></li><li><a href="https://github.com/diegomura/react-pdf" target="_blank" rel="noreferrer">react-pdf/github</a></li></ul></li><li>相关的使用方式可以参考博客 <ul><li><a href="https://usefulangle.com/post/20/pdfjs-tutorial-1-preview-pdf-during-upload-wih-next-prev-buttons" target="_blank" rel="noreferrer">How to Display PDF in HTML Page using Javascript PDF.JS Library</a></li><li><a href="https://pspdfkit.com/blog/2018/render-pdfs-in-the-browser-with-pdf-js/" target="_blank" rel="noreferrer">Rendering PDF Files in the Browser with PDF.js</a></li><li><a href="https://openbase.com/categories/js/best-javascript-pdf-viewer-libraries" target="_blank" rel="noreferrer">10 Best JavaScript PDF Viewer Libraries - Openbase</a></li></ul></li></ul><p><strong>参考资料：</strong></p><ul><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLIFrameElement" target="_blank" rel="noreferrer">HTMLIFrameElement/MDN</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Learn/HTML/Multimedia_and_embedding/Other_embedding_technologies" target="_blank" rel="noreferrer">从对象到iframe - 其他嵌入技术/MDN</a></li><li><a href="https://www.cnblogs.com/RuMengkai/p/6230917.html" target="_blank" rel="noreferrer">iframe focus/focusin/blur/focusout 事件</a></li><li><a href="https://www.cnblogs.com/mark21/p/13503271.html" target="_blank" rel="noreferrer">iframe click 事件无效</a></li><li><a href="https://stackoverflow.com/questions/6452502/adding-click-event-handler-to-iframe" target="_blank" rel="noreferrer">Adding click event handler to iframe</a></li><li><a href="https://zhuanlan.zhihu.com/p/38392987" target="_blank" rel="noreferrer">如何解决 iframe 无法触发 clickOutside</a></li><li><a href="https://stackoverflow.com/questions/10071431/apply-onclick-to-iframe/44389097" target="_blank" rel="noreferrer">Apply onClick to Iframe</a></li></ul><p><strong>iframe的坑-合集：</strong></p><blockquote><p>google 搜索关键字 <em>iframe 坑</em></p></blockquote><ul><li><a href="https://www.jianshu.com/p/1c1c2bcd027a" target="_blank" rel="noreferrer">填坑之路：iframe的各种坑</a></li><li><a href="https://www.zhihu.com/question/23683645" target="_blank" rel="noreferrer">为什么前端尽量少用iframe?-知乎</a></li><li><a href="https://juejin.cn/post/6861931394218590221" target="_blank" rel="noreferrer">使用iframe遇到的坑</a></li><li><a href="https://segmentfault.com/a/1190000020144165" target="_blank" rel="noreferrer">iframe onload事件被block的巨坑</a></li></ul><p><strong>优化</strong></p><ul><li>实现对 多图模式预览列表优化 <ul><li>图片容器长度小于 modal 时，不出现左右切换，图片仅仅居中展示；</li><li>图片容器长度大于 modal 时，出现左右切换；</li></ul></li><li>目的： <ul><li>避免在不需要切换图片列表的时候，出现了切换按钮误导用户；</li><li>提升用户体验；</li></ul></li></ul><p><strong>巧妙实现</strong></p><ul><li>clickAway 实现： <ul><li>原方案：参考 <a href="https://ahooks.js.org/zh-CN/hooks/use-click-away" target="_blank" rel="noreferrer">useClickAway/ahooks.js</a></li><li>无法实现原因：要求不能使用蒙层，点击弹框以外的元素关闭弹框；因为弹框放到了 body 下，鼠标点中的其他区域无法操作 <code>clickedElement.contains(modalElement)</code>；</li><li>新方案：react v.17.x 事件系统挂在 container 上，modal 点击蒙层关闭的问题就很好解决了</li></ul></li></ul><p>新方案：</p><ul><li>modal 挂载的时候注入 全局的 document.click 事件，触发操作是关闭弹框；</li><li>modal 顶层元素监听 onclick 事件，e.stopPropagation();阻止冒泡；</li><li>外部 DOM 操作若想要点击但是不想蒙层关闭，直接使用 e.stopPropagation() 即可;</li></ul><h2 id="todos" tabindex="-1">TODOS <a class="header-anchor" href="#todos" aria-label="Permalink to &quot;TODOS&quot;">​</a></h2><blockquote><p>短期内要做的事情</p></blockquote><ul><li><a href="https://ahooks.js.org/zh-CN/hooks/use-request/index" target="_blank" rel="noreferrer">阅读 ahooks 源码</a> 深入 react-hook</li></ul>',23),o=[i];function n(s,c,h,p,f,u){return r(),l("div",null,o)}const g=e(t,[["render",n]]);export{m as __pageData,g as default};
